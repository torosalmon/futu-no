{"version":3,"sources":["blog/wp-content/themes/futu-no/js/script.js"],"names":["supportsPassive","opts","Object","defineProperty","get","window","addEventListener","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","$body","document","getElementsByTagName","$header","color_accent","getComputedStyle","color_sub","$drawer","$meta_accent_color","querySelector","e","MENU","HTML_SUPPORT","_classCallCheck","this","scroll_header","drawer","_createClass","key","value","toggle","pageYOffset","offset","classList","add","event_interval","passive","getElementsByClassName","contains","remove","borderTopColor","style","$toggle","background_scroll","arg_state","timer","setInterval","body","scrollHeight","innerHeight","clearInterval","setAttribute","$open","smooth_scroll","source_highlight","SweetScroll","trigger","header","duration","delay","easing","verticalScroll","horizontalScroll","stopScroll","hljs","initHighlightingOnLoad","$video","i","length"],"mappings":"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","file":"script.js","sourcesContent":["/*!\n * *****************************************************************************\n * [futu-no JavaScript]\n * @URL:     http://trs.mn/blog/futu-no/\n * @License: MIT License\n * *****************************************************************************\n!*/\n\n// =============================================================================\n// Passive Event Listeners - Feature Detection\n// =============================================================================\n\nvar supportsPassive = false;\ntry {\n  var opts = Object.defineProperty({}, 'passive', {\n    get: function() {\n      supportsPassive = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n}\ncatch(e) {}\n\n// =============================================================================\n// requestAnimationFrame - Polyfill\n// =============================================================================\n\nwindow.requestAnimationFrame = window.requestAnimationFrame\n                            || window.mozRequestAnimationFrame\n                            || window.webkitRequestAnimationFrame\n                            || window.oRequestAnimationFrame\n                            || window.msRequestAnimationFrame;\n\n// =============================================================================\n// Mainstream\n// =============================================================================\n\n{\n  'use strict';\n\n  // ==============\n  // グローバル変数\n  // ==============\n\n  const $body   = document.getElementsByTagName('body')[0];\n  const $header = document.getElementsByTagName('header')[0];\n  const $drawer = document.getElementsByClassName('drawer')[0];\n\n  // ============\n  // テーマカラー\n  // ============\n\n  // <header> border-top-colorからアクセントカラーを取得\n  let color_accent = getComputedStyle($header);\n      color_accent = color_accent.borderTopColor;\n\n  // <.drawer> background-colorからサブカラーを取得\n  let color_sub = getComputedStyle($drawer);\n      color_sub = color_sub.backgroundColor;\n\n  // テーマカラーセット\n  let $meta_accent_color = document.querySelector('meta[name=\"theme-color\"]');\n      $meta_accent_color.setAttribute('content', color_accent);\n\n  // ================\n  // DOMContentLoaded\n  // ================\n\n  document.addEventListener('DOMContentLoaded', function(e) {\n    const menu         = new MENU();\n    const html_support = new HTML_SUPPORT();\n  }, false);\n\n  // =============================================================================\n  // メニュー\n  // =============================================================================\n\n  class MENU {\n\n    constructor() {\n      this.scroll_header();\n      this.drawer();\n      this.share_overlay();\n      this.search_form();\n    }\n\n    // ===============================\n    // ヘッダー スクロール表示切り替え\n    // ===============================\n\n    scroll_header() {\n      const offset = 80; // 起動させるスクロール座標\n\n      window.addEventListener('scroll', event_interval, supportsPassive ? { passive: true } : false);\n      document.addEventListener('touchmove', event_interval, supportsPassive ? { passive: true } : false);\n\n      // イベント発火調整\n      function event_interval() {\n        window.requestAnimationFrame(toggle);\n      }\n\n      // 表示切り替え\n      function toggle() {\n        if(window.pageYOffset > offset) {\n          $body.classList.add('show-scroll-header');\n        }\n        else {\n          $body.classList.remove('show-scroll-header');\n        }\n      }\n      toggle();\n    }\n\n    // ========\n    // ドロワー\n    // ========\n\n    drawer() {\n\n      // ============\n      // ドロワー開閉\n      // ============\n\n      const $toggle = document.getElementsByClassName('js-drawer-toggle')[0];\n      $toggle.addEventListener('click', function() {\n        if(!$body.classList.contains('show-drawer')) {\n          $body.classList.remove('show-search-form');\n          $body.classList.add('show-drawer');\n\n          $meta_accent_color.setAttribute('content', color_sub);\n          $header.style.borderTopColor = color_sub;\n        }\n        else {\n          $body.classList.remove('show-drawer');\n\n          $meta_accent_color.setAttribute('content', color_accent);\n          $header.style.borderTopColor = color_accent;\n        }\n      }, false);\n    }\n\n    // ================\n    // 共有オーバーレイ\n    // ================\n\n    share_overlay() {\n\n      // ================\n      // オーバーレイ開閉\n      // ================\n\n      const $open = document.getElementsByClassName('js-share-overlay-open')[0];\n      $open.addEventListener('click', function() {\n        $body.classList.add('show-share-overlay');\n\n        // 背景スクロール開始\n        background_scroll('start');\n      }, false);\n\n      const $close = document.getElementsByClassName('js-share-overlay-close')[0];\n      $close.addEventListener('click', function() {\n        $body.classList.remove('show-share-overlay');\n\n        // 背景スクロール停止\n        background_scroll('stop');\n      }, false);\n\n      // ==================\n      // 背景スクロール演出\n      // ==================\n\n      let timer;\n      function background_scroll(arg_state) {\n\n        // 開始\n        if(arg_state === 'start') {\n          timer = setInterval(function() {\n            if(window.pageYOffset === document.body.scrollHeight - window.innerHeight) {\n              window.scrollTo(0, 0);\n            }\n            else {\n              window.scrollBy(0, 1);\n            }\n          }, 30);\n        }\n\n        // 停止\n        else if(arg_state === 'stop') {\n          clearInterval(timer);\n        }\n      }\n\n    }\n\n    // ============\n    // 検索フォーム\n    // ============\n\n    search_form() {\n\n      // ============\n      // フォーム開閉\n      // ============\n\n      const $open = document.getElementsByClassName('js-search-form-open')[0];\n      $open.addEventListener('click', function() {\n        $body.classList.remove('show-drawer');\n        $body.classList.add('show-search-form');\n\n        $meta_accent_color.setAttribute('content', color_sub);\n        $header.style.borderTopColor = color_sub;\n      }, false);\n\n      const $close = document.getElementsByClassName('js-search-form-close')[0];\n      $close.addEventListener('click', function() {\n        $body.classList.remove('show-search-form');\n\n        $meta_accent_color.setAttribute('content', color_accent);\n        $header.style.borderTopColor = color_accent;\n      }, false);\n    }\n\n  }\n\n  // =============================================================================\n  // HTML 機能補完\n  // =============================================================================\n\n  class HTML_SUPPORT {\n\n    constructor() {\n      this.smooth_scroll();\n      if(document.querySelector('pre code') != null) {\n        this.source_highlight();\n      }\n      if(document.getElementsByTagName('video')[0] != null) {\n        this.inline_playing_video();\n      }\n    }\n\n    // ==================\n    // スムーススクロール\n    // ==================\n\n    // [API]\n    // sweet-scroll.js\n    // https://github.com/tsuyoshiwada/sweet-scroll\n\n    smooth_scroll() {\n      const sweetScroll = new SweetScroll({\n        trigger: '.js-scroll',   // トリガーとなる要素をCSSセレクタで指定\n        header: 'header',        // 固定ヘッダをCSSセレクタで指定\n        duration: 900,           // アニメーション再生時間のミリ秒\n        delay: 0,                // アニメーション開始までの遅延ミリ秒\n        easing: 'easeOutExpo',   // イージングのタイプ（デフォルト：easeOutQuint）\n        offset: 0,               // スクロール位置のオフセット\n        verticalScroll: true,    // 垂直方向のスクロールを許可\n        horizontalScroll: false, // 水平方向のスクロールを許可 (デフォルトでは無効)\n        stopScroll: true,        // ホイール・タッチイベントが発生した時にスクロールを停止\n\n        // Callbacks\n        beforeScroll: null,      // スクロールが始まる前 (return falseでキャンセル可)\n        afterScroll: null,       // スクロールが終わった時\n        cancelScroll: null       // スクロールがキャンセルされた時\n      });\n    }\n\n    // ================\n    // コードハイライト\n    // ================\n\n    // [API]\n    // highlight.js\n    // https://highlightjs.org/\n\n    source_highlight() {\n      hljs.initHighlightingOnLoad();\n    }\n\n    // ====================\n    // 動画のインライン再生\n    // ====================\n\n    inline_playing_video() {\n      const $video = document.getElementsByTagName('video');\n      for(let i = 0; i < $video.length; i ++) {\n        $video[i].setAttribute('webkit-playsinline', 'webkit-playsinline');\n      }\n    }\n\n  }\n\n}\n"]}