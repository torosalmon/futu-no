{"version":3,"sources":["blog/wp-content/themes/futu-no/js/script.js"],"names":["supportsPassive","opts","Object","defineProperty","get","window","addEventListener","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","$meta_theme_color","document","querySelector","$body","getElementsByTagName","$header","$drawer","getElementsByClassName","color_accent","getComputedStyle","borderTopColor","color_sub","backgroundColor","setAttribute","e","MENU","HTML_SUPPORT","_classCallCheck","this","scroll_header","drawer","search_form","share_overlay","event_interval","toggle","passive","pageYOffset","offset","classList","add","contains","remove","$toggle","style","$open","background_scroll","arg_state","timer","setInterval","body","scrollHeight","innerHeight","scrollTo","scrollBy","clearInterval","smooth_scroll","source_highlight","inline_playing_video","trigger","header","duration","delay","easing","verticalScroll","horizontalScroll","stopScroll","afterScroll","$video","i","length"],"mappings":"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","file":"script.js","sourcesContent":["/*!\n * *****************************************************************************\n * [futu-no JavaScript]\n * @URL:     http://trs.mn/blog/futu-no/\n * @License: MIT License\n * *****************************************************************************\n!*/\n\n// =============================================================================\n// Polyfill\n// =============================================================================\n\n// =======================\n// Passive Event Listeners\n// =======================\n\nvar supportsPassive = false;\ntry {\n  var opts = Object.defineProperty({}, 'passive', {\n    get: function() {\n      supportsPassive = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n} catch (e) {}\n\n// =====================\n// requestAnimationFrame\n// =====================\n\nwindow.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame;\n\n// =============================================================================\n// Mainstream\n// =============================================================================\n\n{\n  'use strict';\n\n  // ==============\n  // グローバル変数\n  // ==============\n\n  const $meta_theme_color = document.querySelector('meta[name=\"theme-color\"]');\n  const $body = document.getElementsByTagName('body')[0];\n  const $header = document.getElementsByTagName('header')[0];\n  const $drawer = document.getElementsByClassName('drawer')[0];\n\n  // ============\n  // テーマカラー\n  // ============\n\n  // <header> border-top-colorからアクセントカラーを取得\n  const color_accent = getComputedStyle($header).borderTopColor;\n  // <.drawer> background-colorからサブカラーを取得\n  const color_sub = getComputedStyle($drawer).backgroundColor;\n  // テーマカラーセット\n  $meta_theme_color.setAttribute('content', color_accent);\n\n  // ================\n  // DOMContentLoaded\n  // ================\n\n  document.addEventListener('DOMContentLoaded', function(e) {\n    const menu = new MENU();\n    const html_support = new HTML_SUPPORT();\n  }, false);\n\n  // =============================================================================\n  // メニュー\n  // =============================================================================\n\n  class MENU {\n\n    constructor() {\n      this.scroll_header();\n      this.drawer();\n      this.search_form();\n      this.share_overlay();\n    }\n\n    // ===============================\n    // ヘッダー スクロール表示切り替え\n    // ===============================\n\n    scroll_header() {\n      // 起動させるスクロール座標\n      const offset = 80;\n\n      window.addEventListener('scroll', event_interval, supportsPassive ? {\n        passive: true\n      } : false);\n      document.addEventListener('touchmove', event_interval, supportsPassive ? {\n        passive: true\n      } : false);\n\n      // イベント発火調整\n      function event_interval() {\n        window.requestAnimationFrame(toggle);\n      }\n\n      // 表示切り替え\n      function toggle() {\n        if (window.pageYOffset > offset) {\n          $body.classList.add('show-scroll-header');\n        } else {\n          $body.classList.remove('show-scroll-header');\n        }\n      }\n      toggle();\n\n    }\n\n    // ========\n    // ドロワー\n    // ========\n\n    drawer() {\n      const $toggle = document.getElementsByClassName('js-drawer-toggle')[0];\n      $toggle.addEventListener('click', function() {\n\n        // 開く\n        if (!$body.classList.contains('show-drawer')) {\n          // ステータス変更\n          $body.classList.remove('show-search-form');\n          $body.classList.add('show-drawer');\n          // テーマカラー変更\n          $meta_theme_color.setAttribute('content', color_sub);\n          $header.style.borderTopColor = color_sub;\n        }\n\n        // 閉じる\n        else {\n          // ステータス変更\n          $body.classList.remove('show-drawer');\n          // テーマカラー変更\n          $meta_theme_color.setAttribute('content', color_accent);\n          $header.style.borderTopColor = color_accent;\n        }\n\n      }, false);\n    }\n\n    // ============\n    // 検索フォーム\n    // ============\n\n    search_form() {\n\n      // 開く\n      const $open = document.getElementsByClassName('js-search-form-open')[0];\n      $open.addEventListener('click', function() {\n        // ステータス変更\n        $body.classList.remove('show-drawer');\n        $body.classList.add('show-search-form');\n        // テーマカラー変更\n        $meta_theme_color.setAttribute('content', color_sub);\n        $header.style.borderTopColor = color_sub;\n      }, false);\n\n      // 閉じる\n      const $close = document.getElementsByClassName('js-search-form-close')[0];\n      $close.addEventListener('click', function() {\n        // ステータス変更\n        $body.classList.remove('show-search-form');\n        // テーマカラー変更\n        $meta_theme_color.setAttribute('content', color_accent);\n        $header.style.borderTopColor = color_accent;\n      }, false);\n\n    }\n\n    // ================\n    // 共有オーバーレイ\n    // ================\n\n    share_overlay() {\n\n      // 開く\n      const $open = document.getElementsByClassName('js-share-overlay-open')[0];\n      $open.addEventListener('click', function() {\n        // ステータス変更\n        $body.classList.add('show-share-overlay');\n        // 背景スクロール開始\n        background_scroll('start');\n      }, false);\n\n      // 閉じる\n      const $close = document.getElementsByClassName('js-share-overlay-close')[0];\n      $close.addEventListener('click', function() {\n        // ステータス変更\n        $body.classList.remove('show-share-overlay');\n        // 背景スクロール停止\n        background_scroll('stop');\n      }, false);\n\n      // ==================\n      // 背景スクロール演出\n      // ==================\n\n      let timer;\n\n      function background_scroll(arg_state) {\n\n        // 開始\n        if (arg_state === 'start') {\n          timer = setInterval(function() {\n            if (window.pageYOffset === document.body.scrollHeight - window.innerHeight) {\n              window.scrollTo(0, 0);\n            } else {\n              window.scrollBy(0, 1);\n            }\n          }, 30);\n        }\n\n        // 停止\n        else if (arg_state === 'stop') {\n          clearInterval(timer);\n        }\n\n      }\n\n    }\n\n  }\n\n  // =============================================================================\n  // HTML 機能補完\n  // =============================================================================\n\n  class HTML_SUPPORT {\n\n    constructor() {\n      this.smooth_scroll();\n      if (document.querySelector('pre code') != null) {\n        this.source_highlight();\n      }\n      if (document.getElementsByTagName('video')[0] != null) {\n        this.inline_playing_video();\n      }\n    }\n\n    // ==================\n    // スムーススクロール\n    // ==================\n\n    // [API]\n    // sweet-scroll.js\n    // https://github.com/tsuyoshiwada/sweet-scroll\n\n    smooth_scroll() {\n      const sweetScroll = new SweetScroll({\n        // トリガーとなる要素をCSSセレクタで指定\n        trigger: '.js-scroll',\n        // 固定ヘッダをCSSセレクタで指定\n        header: 'header',\n        // アニメーション再生時間のミリ秒\n        duration: 900,\n        // アニメーション開始までの遅延ミリ秒\n        delay: 0,\n        // イージングのタイプ（デフォルト：easeOutQuint）\n        easing: 'easeOutExpo',\n        // スクロール位置のオフセット\n        offset: 0,\n        // 垂直方向のスクロールを許可\n        verticalScroll: true,\n        // 水平方向のスクロールを許可 (デフォルトでは無効)\n        horizontalScroll: false,\n        // ホイール・タッチイベントが発生した時にスクロールを停止\n        stopScroll: true,\n\n        // Callbacks\n\n        // スクロールが始まる前 (return falseでキャンセル可)\n        beforeScroll: null,\n        // スクロールが終わった時\n        afterScroll: null,\n        // スクロールがキャンセルされた時\n        cancelScroll: null\n      });\n    }\n\n    // ================\n    // コードハイライト\n    // ================\n\n    // [API]\n    // highlight.js\n    // https://highlightjs.org/\n\n    source_highlight() {\n      hljs.initHighlightingOnLoad();\n    }\n\n    // ====================\n    // 動画のインライン再生\n    // ====================\n\n    inline_playing_video() {\n      const $video = document.getElementsByTagName('video');\n      for (let i = 0; i < $video.length; i++) {\n        $video[i].setAttribute('webkit-playsinline', 'webkit-playsinline');\n      }\n    }\n\n  }\n\n}\n"]}