{"version":3,"sources":["futu-no/js/script.js"],"names":["supportsPassive","opts","Object","defineProperty","get","window","addEventListener","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","document","e","$body","getElementsByTagName","$header","$drawer","getElementsByClassName","color_accent","getComputedStyle","borderTopColor","color_sub","$meta_accent_color","querySelector","menu","_classCallCheck","this","scroll_header","drawer","share_overlay","search_form","_createClass","key","value","event_interval","toggle","classList","add","remove","offset","passive","contains","$toggle","setAttribute","style","background_scroll","arg_state","timer","setInterval","pageYOffset","body","scrollHeight","innerHeight","scrollTo","scrollBy","$open","html_upgrade","smooth_scroll","source_highlight","inline_playing_video","trigger","header","duration","delay","easing","verticalScroll","horizontalScroll","stopScroll","beforeScroll","afterScroll","cancelScroll","$video","i","length"],"mappings":"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","file":"script.js","sourcesContent":["/*!\n * *****************************************************************************\n * [futu-no JavaScript]\n * @URL:     http://trs.mn/blog/futu-no/\n * @License: MIT License\n * *****************************************************************************\n!*/\n\n// =============================================================================\n// init\n// =============================================================================\n\n// Passive Event Listeners - Feature Detection\nvar supportsPassive = false;\ntry {\n  var opts = Object.defineProperty({}, 'passive', {\n    get: function() {\n      supportsPassive = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n}\ncatch(e) {}\n\n// requestAnimationFrame - Vendor Prefix\nlet requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\nwindow.requestAnimationFrame = requestAnimationFrame;\n\n// =============================================================================\n// DOMContentLoaded\n// =============================================================================\n\ndocument.addEventListener('DOMContentLoaded', function(e) {\n  'use strict';\n\n  // ==============\n  // グローバル変数\n  // ==============\n\n  const $body   = document.getElementsByTagName('body')[0];\n  const $header = document.getElementsByTagName('header')[0];\n  const $drawer = document.getElementsByClassName('drawer')[0];\n\n  // ============\n  // テーマカラー\n  // ============\n\n  // <header> border-top-colorからアクセントカラーを取得\n  let color_accent = getComputedStyle($header);\n      color_accent = color_accent.borderTopColor;\n\n  // <.drawer> background-colorからサブカラーを取得\n  let color_sub = getComputedStyle($drawer);\n      color_sub = color_sub.backgroundColor;\n\n  // テーマカラーセット\n  let $meta_accent_color = document.querySelector('meta[name=\"theme-color\"]');\n      $meta_accent_color.setAttribute('content', color_accent);\n\n// =============================================================================\n// メニュー\n// =============================================================================\n\n  class menu {\n\n    constructor() {\n      this.scroll_header();\n      this.drawer();\n      this.share_overlay();\n      this.search_form();\n    }\n\n    // ===============================\n    // ヘッダー スクロール表示切り替え\n    // ===============================\n\n    scroll_header() {\n      const offset = 80; // 起動させるスクロール座標\n\n      window.addEventListener('scroll', event_interval, supportsPassive ? { passive: true } : false);\n      document.addEventListener('touchmove', event_interval, supportsPassive ? { passive: true } : false);\n\n      function event_interval() {\n        window.requestAnimationFrame(toggle);\n      }\n\n      // 表示切り替え\n      function toggle() {\n        if(window.pageYOffset > offset) {\n          $body.classList.add('show-scroll-header');\n        }\n        else {\n          $body.classList.remove('show-scroll-header');\n        }\n      }\n      toggle();\n    }\n\n    // ========\n    // ドロワー\n    // ========\n\n    drawer() {\n\n      // ============\n      // ドロワー開閉\n      // ============\n\n      const $toggle = document.getElementsByClassName('js-drawer-toggle')[0];\n      $toggle.addEventListener('click', function() {\n        if(!$body.classList.contains('show-drawer')) {\n          $body.classList.remove('show-search-form');\n          $body.classList.add('show-drawer');\n\n          $meta_accent_color.setAttribute('content', color_sub);\n          $header.style.borderTopColor = color_sub;\n        }\n        else {\n          $body.classList.remove('show-drawer');\n\n          $meta_accent_color.setAttribute('content', color_accent);\n          $header.style.borderTopColor = color_accent;\n        }\n      }, false);\n    }\n\n    // ================\n    // 共有オーバーレイ\n    // ================\n\n    share_overlay() {\n\n      // ================\n      // オーバーレイ開閉\n      // ================\n\n      const $open = document.getElementsByClassName('js-share-overlay-open')[0];\n      $open.addEventListener('click', function() {\n        $body.classList.add('show-share-overlay');\n\n        // 背景スクロール開始\n        background_scroll('start');\n      }, false);\n\n      const $close = document.getElementsByClassName('js-share-overlay-close')[0];\n      $close.addEventListener('click', function() {\n        $body.classList.remove('show-share-overlay');\n\n        // 背景スクロール停止\n        background_scroll('stop');\n      }, false);\n\n      // ==================\n      // 背景スクロール演出\n      // ==================\n\n      let timer;\n\n      function background_scroll(arg_state) {\n\n        // 開始\n        if(arg_state === 'start') {\n          timer = setInterval(function() {\n            if(window.pageYOffset === document.body.scrollHeight - window.innerHeight) {\n              window.scrollTo(0, 0);\n            }\n            else {\n              window.scrollBy(0, 1);\n            }\n          }, 30);\n        }\n\n        // 停止\n        else if(arg_state === 'stop') {\n          clearInterval(timer);\n        }\n      }\n\n    }\n\n    // ============\n    // 検索フォーム\n    // ============\n\n    search_form() {\n\n      // ============\n      // フォーム開閉\n      // ============\n\n      const $open = document.getElementsByClassName('js-search-form-open')[0];\n      $open.addEventListener('click', function() {\n        $body.classList.remove('show-drawer');\n        $body.classList.add('show-search-form');\n\n        $meta_accent_color.setAttribute('content', color_sub);\n        $header.style.borderTopColor = color_sub;\n      }, false);\n\n      const $close = document.getElementsByClassName('js-search-form-close')[0];\n      $close.addEventListener('click', function() {\n        $body.classList.remove('show-search-form');\n\n        $meta_accent_color.setAttribute('content', color_accent);\n        $header.style.borderTopColor = color_accent;\n      }, false);\n    }\n\n  }\n\n  const Menu = new menu();\n\n// =============================================================================\n// HTML 機能補完\n// =============================================================================\n\n  class html_upgrade {\n\n    constructor() {\n      this.smooth_scroll();\n      if(document.querySelector('pre code') != null) {\n        this.source_highlight();\n      }\n      if(document.getElementsByTagName('video')[0] != null) {\n        this.inline_playing_video();\n      }\n    }\n\n    // ==================\n    // スムーススクロール\n    // ==================\n\n    // [API]\n    // sweet-scroll.js\n    // https://github.com/tsuyoshiwada/sweet-scroll\n\n    smooth_scroll() {\n      const sweetScroll = new SweetScroll({\n        trigger: '.js-scroll',   // トリガーとなる要素をCSSセレクタで指定\n        header: 'header',        // 固定ヘッダをCSSセレクタで指定\n        duration: 900,           // アニメーション再生時間のミリ秒\n        delay: 0,                // アニメーション開始までの遅延ミリ秒\n        easing: 'easeOutExpo',   // イージングのタイプ（デフォルト：easeOutQuint）\n        offset: 0,               // スクロール位置のオフセット\n        verticalScroll: true,    // 垂直方向のスクロールを許可\n        horizontalScroll: false, // 水平方向のスクロールを許可 (デフォルトでは無効)\n        stopScroll: true,        // ホイール・タッチイベントが発生した時にスクロールを停止\n\n        // Callbacks\n        beforeScroll: null,      // スクロールが始まる前 (return falseでキャンセル可)\n        afterScroll: null,       // スクロールが終わった時\n        cancelScroll: null       // スクロールがキャンセルされた時\n      });\n    }\n\n    // ================\n    // コードハイライト\n    // ================\n\n    // [API]\n    // highlight.js\n    // https://highlightjs.org/\n\n    source_highlight() {\n      hljs.initHighlightingOnLoad();\n    }\n\n    // ====================\n    // 動画のインライン再生\n    // ====================\n\n    inline_playing_video() {\n      const $video = document.getElementsByTagName('video');\n      for(let i = 0; i < $video.length; i ++) {\n        $video[i].setAttribute('webkit-playsinline', 'webkit-playsinline');\n      }\n    }\n\n  }\n\n  const HTML_upgrade = new html_upgrade();\n\n}, false);\n"]}